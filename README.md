# Human vs. LLM Linguistic Differences: Predictive Power of Language Style Matching (LSM)

# Contributors
- **François-Xavier BONNEFONT**
- **Zaher HAMADEH**
- **William JAN**
- **Andrew MAHO**

---

## Introduction

This project investigates whether **Language Style Matching (LSM)** — a psycholinguistic measure of stylistic synchronization — can distinguish **human empathic dialogues** from those generated by **large language models (LLMs)** such as ChatGPT-3.5.  

By focusing on linguistic style rather than content, LSM quantifies how similarly speakers use function words, offering an interpretable marker of empathy and affective coordination.  
Our study compares the predictive power of LSM with affective and semantic features extracted from dialogues.

---

## Project Overview

This notebook reproduces and extends the analysis described in *“Analysis of Human vs. LLM Discrimination in Empathic Dialogues: Predictive Power of LSM and Affective Features.”*

### Main Objectives
- Compute **LSM** scores for pairs of empathic dialogues (Human vs ChatGPT-3.5).  
- Extract **affective features** using the [**ELFEN**](https://github.com/mmmaurer/elfen) library.  
- Generate **semantic embeddings** using pre-trained Sentence Transformers (`all-MiniLM-L6-v2`).  
- Train and evaluate interpretable **logistic regression** models to assess the contribution of LSM.

---

## Data Description

The project uses two public datasets described by **Sandler et al. (2024)**:

| Corpus | Description | Size |
|---------|--------------|------|
| **EmpathicDialogues** | Human-generated empathic conversations (MTurk) | ~25 000 dialogues |
| **2GPT-EmpathicDialogues** | AI-generated dialogues between two ChatGPT-3.5-Turbo instances | ~19 500 dialogues |

You can download both datasets here:

- [EmpathicDialogues (Hugging Face)](https://huggingface.co/datasets/facebook/EmpatheticDialogues)  
- [2GPT-EmpathicDialogues (Sandler et al., 2024)](https://github.com/msandler/2GPTEmpathicDialogues)

After download, place the data files in:
data/
├── empathicdialogues/
├── 2gpt_empathicdialogues/

## Install dependencies
**Install dependencies listed in requirements.txt, including spaCy, sentence-transformers, and ELFEN :**
pip install -r requirements.txt

**Or manually:**
pip install spacy sentence-transformers pandas scikit-learn matplotlib seaborn
pip install git+https://github.com/mmmaurer/elfen.git

**Loading the Pre-Trained spaCy Model**
Install the English model for linguistic analysis and tokenization:
python -m spacy download en_core_web_sm

## References
1. Sandler, M., Choung, H., Ross, A., & David, P. (2024). A Linguistic Comparison between Human and ChatGPT-Generated Conversations.arXiv:2401.16587v3 [cs.CL].
2. Pennebaker, J. W. et al. (2015). LIWC2015 Manual. University of Texas at Austin.
3. Reimers, N., & Gurevych, I. (2019). Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks. EMNLP.
4. Maurer, M. (2023). ELFEN: Efficient Linguistic Feature Extraction for Natural Language Datasets. GitHub.
5. Explosion AI. (2024). spaCy Library Documentation.
6. Hosmer, D. W., Lemeshow, S., & Sturdivant, R. X. (2013). Applied Logistic Regression. Wiley.